<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FLATHUNT.EXE - Property Search v1.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --terminal-black: #0D0D0D;
            --terminal-green: #00FF41;
            --terminal-blue: #0066FF;
            --hot-pink: #FF006E;
            --safety-yellow: #FFBE0B;
            --brutalist-grey: #D9D9D9;
            --window-grey: #C0C0C0;
            --border-dark: #808080;
            --border-light: #FFFFFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--terminal-black);
            color: var(--terminal-green);
            padding: 20px;
            line-height: 1.4;
            cursor: default;
        }

        /* RETRO WINDOW CHROME */
        .window {
            background: var(--window-grey);
            border: 3px solid;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }

        .window-title-bar {
            background: linear-gradient(90deg, #000080, #1084d0);
            color: white;
            padding: 4px 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: bold;
            font-size: 13px;
            font-family: 'Space Mono', monospace;
        }

        .window-title {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .window-controls {
            display: flex;
            gap: 4px;
        }

        .window-btn {
            width: 18px;
            height: 18px;
            background: var(--window-grey);
            border: 2px solid;
            border-color: var(--border-light) var(--border-dark) var(--border-dark) var(--border-light);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            color: black;
        }

        .window-btn:active {
            border-color: var(--border-dark) var(--border-light) var(--border-light) var(--border-dark);
        }

        .window-content {
            padding: 16px;
            background: var(--window-grey);
            color: black;
        }

        /* HEADER - TERMINAL STYLE */
        .terminal-header {
            background: var(--terminal-black);
            color: var(--terminal-green);
            padding: 20px;
            font-family: 'Space Mono', monospace;
            border: 3px solid var(--terminal-green);
            margin-bottom: 20px;
        }

        .terminal-prompt {
            font-size: 14px;
            margin-bottom: 12px;
        }

        .terminal-prompt::before {
            content: '> ';
            color: var(--hot-pink);
        }

        .ascii-title {
            font-size: 11px;
            line-height: 1.2;
            color: var(--terminal-green);
            white-space: pre;
            margin-bottom: 12px;
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 12px;
            padding-top: 12px;
            border-top: 1px solid var(--terminal-green);
        }

        .stat-item {
            display: flex;
            gap: 6px;
        }

        .stat-label {
            color: var(--brutalist-grey);
        }

        .stat-value {
            color: var(--terminal-green);
            font-weight: bold;
        }

        /* FILTERS - SYSTEM SETTINGS PANEL */
        .filter-panel {
            background: var(--brutalist-grey);
            padding: 12px;
            border: 4px solid black;
        }

        .filter-title {
            font-family: 'Space Mono', monospace;
            font-weight: bold;
            margin-bottom: 12px;
            font-size: 13px;
            border-bottom: 2px solid black;
            padding-bottom: 4px;
        }

        .filter-title::before {
            content: '‚öô ';
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
            margin-bottom: 12px;
        }

        .filter-group label {
            display: block;
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 4px;
            text-transform: uppercase;
            font-family: 'Space Mono', monospace;
        }

        .filter-group select {
            width: 100%;
            padding: 6px;
            border: 3px solid black;
            background: white;
            font-family: 'Space Mono', monospace;
            font-size: 12px;
            cursor: pointer;
        }

        .filter-group select:focus {
            outline: 3px solid var(--hot-pink);
            outline-offset: -3px;
        }

        .btn-brutalist {
            padding: 8px 16px;
            background: var(--hot-pink);
            color: white;
            border: 4px solid black;
            font-family: 'Space Mono', monospace;
            font-weight: bold;
            font-size: 12px;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.1s;
        }

        .btn-brutalist:hover {
            background: var(--safety-yellow);
            color: black;
        }

        .btn-brutalist:active {
            transform: translate(2px, 2px);
        }

        /* TABLE - FILE BROWSER STYLE */
        .file-browser {
            background: white;
            border: 4px solid black;
            overflow-x: auto;
        }

        .file-browser-header {
            background: var(--brutalist-grey);
            padding: 8px;
            border-bottom: 3px solid black;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        th {
            background: var(--brutalist-grey);
            padding: 10px 8px;
            text-align: left;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            font-weight: bold;
            text-transform: uppercase;
            border-bottom: 3px solid black;
            border-right: 2px solid var(--border-dark);
            cursor: pointer;
            user-select: none;
        }

        th:last-child {
            border-right: none;
        }

        th:hover {
            background: var(--safety-yellow);
        }

        th.sortable::after {
            content: ' ‚ñ≤‚ñº';
            color: var(--border-dark);
            font-size: 8px;
        }

        th.sorted-asc::after {
            content: ' ‚ñ≤';
            color: black;
        }

        th.sorted-desc::after {
            content: ' ‚ñº';
            color: black;
        }

        tr {
            border-bottom: 1px solid var(--brutalist-grey);
        }

        tr:hover {
            background: #FFFFCC;
        }

        tr.top-pick {
            background: #FFE6F0;
            border-left: 6px solid var(--hot-pink);
        }

        tr.top-pick:hover {
            background: #FFD6E8;
        }

        td {
            padding: 12px 8px;
            vertical-align: middle;
            border-right: 1px solid var(--brutalist-grey);
        }

        td:last-child {
            border-right: none;
        }

        /* BADGES & SCORES */
        .score-box {
            display: inline-block;
            padding: 4px 10px;
            border: 3px solid black;
            font-family: 'Space Mono', monospace;
            font-weight: bold;
            font-size: 14px;
            min-width: 50px;
            text-align: center;
        }

        .score-excellent {
            background: var(--terminal-green);
            color: black;
        }

        .score-good {
            background: var(--safety-yellow);
            color: black;
        }

        .score-fair {
            background: var(--hot-pink);
            color: white;
        }

        .score-unknown {
            background: var(--brutalist-grey);
            color: black;
        }

        .badge-brutal {
            display: inline-block;
            padding: 2px 6px;
            border: 2px solid black;
            font-family: 'Space Mono', monospace;
            font-size: 9px;
            font-weight: bold;
            margin-left: 4px;
            text-transform: uppercase;
        }

        .badge-new {
            background: var(--terminal-blue);
            color: white;
        }

        .badge-top {
            background: var(--hot-pink);
            color: white;
        }

        .property-link {
            color: #0000EE;
            text-decoration: underline;
            font-weight: 600;
            cursor: pointer;
        }

        .property-link:visited {
            color: #551A8B;
        }

        .property-link:hover {
            background: yellow;
            color: black;
        }

        .meta-text {
            font-size: 11px;
            color: #666;
            font-family: 'Space Mono', monospace;
        }

        .commute-text {
            font-family: 'Space Mono', monospace;
            font-size: 12px;
            font-weight: bold;
        }

        .commute-excellent { color: #008000; }
        .commute-good { color: #FF8C00; }
        .commute-fair { color: #DC143C; }
        .commute-unknown { color: #666; }

        /* FOOTER - SHAMELESS CTA */
        .footer-chaos {
            background: var(--terminal-black);
            color: var(--terminal-green);
            padding: 20px;
            font-family: 'Space Mono', monospace;
            font-size: 11px;
            border: 3px solid var(--terminal-green);
            margin-top: 20px;
            line-height: 1.8;
        }

        .footer-chaos a {
            color: var(--hot-pink);
            text-decoration: none;
            border-bottom: 1px solid var(--hot-pink);
        }

        .footer-chaos a:hover {
            background: var(--hot-pink);
            color: white;
        }

        /* EASTER EGG - KONAMI CODE ACTIVATED */
        .konami-activated {
            animation: rainbow 2s infinite;
        }

        @keyframes rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }

        /* MOBILE - STACK BRUTALLY */
        @media (max-width: 860px) {
            body { padding: 10px; }

            .filter-grid {
                grid-template-columns: 1fr;
            }

            table, thead, tbody, th, td, tr {
                display: block;
            }

            thead {
                display: none;
            }

            tr {
                border: 3px solid black;
                margin-bottom: 12px;
                padding: 12px;
                background: white;
            }

            tr.top-pick {
                border-top: 6px solid var(--hot-pink);
            }

            td {
                display: flex;
                justify-content: space-between;
                padding: 8px 0;
                border-right: none;
                border-bottom: 1px solid var(--brutalist-grey);
            }

            td:last-child {
                border-bottom: none;
            }

            td::before {
                content: attr(data-label);
                font-family: 'Space Mono', monospace;
                font-weight: bold;
                font-size: 10px;
                text-transform: uppercase;
            }
        }
    </style>
</head>
<body>
    <!-- TERMINAL HEADER -->
    <div class="terminal-header">
        <div class="terminal-prompt">flathunt.exe --mode=desperate --budget=low --location=north-london</div>
        <pre class="ascii-title">‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó      ‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïó‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ïó   ‚ñà‚ñà‚ïó‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó
‚ñà‚ñà‚ïî‚ïê‚ïê‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïó‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë‚ïö‚ïê‚ïê‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù
‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó  ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïî‚ñà‚ñà‚ïó ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïî‚ïê‚ïê‚ïù  ‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïî‚ïê‚ïê‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë
‚ñà‚ñà‚ïë     ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïó‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë  ‚ñà‚ñà‚ïë‚ïö‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ïî‚ïù‚ñà‚ñà‚ïë ‚ïö‚ñà‚ñà‚ñà‚ñà‚ïë   ‚ñà‚ñà‚ïë
‚ïö‚ïê‚ïù     ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù   ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïù ‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù ‚ïö‚ïê‚ïù  ‚ïö‚ïê‚ïê‚ïê‚ïù   ‚ïö‚ïê‚ïù</pre>
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-label">LAST_SCAN:</span>
                <span class="stat-value">26.02.2026</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">PROPERTIES_FOUND:</span>
                <span class="stat-value" id="total-count">13</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">BUDGET_RANGE:</span>
                <span class="stat-value">¬£2k-3k/mo</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">PLATFORMS:</span>
                <span class="stat-value">Rightmove + Zoopla</span>
            </div>
            <div class="stat-item">
                <span class="stat-label">STATUS:</span>
                <span class="stat-value" style="color: var(--hot-pink);">ACTIVELY DESPERATE</span>
            </div>
        </div>
    </div>

    <!-- FILTERS WINDOW -->
    <div class="window">
        <div class="window-title-bar">
            <div class="window-title">
                <span>‚öô</span>
                <span>FILTERS.SYS - Search Parameters</span>
            </div>
            <div class="window-controls">
                <div class="window-btn">_</div>
                <div class="window-btn">‚ñ°</div>
                <div class="window-btn" onclick="alert('Nice try. No escape from flat hunting.')">√ó</div>
            </div>
        </div>
        <div class="window-content">
            <div class="filter-panel">
                <div class="filter-title">SEARCH CONSTRAINTS</div>
                <div class="filter-grid">
                    <div class="filter-group">
                        <label>BEDS.cfg</label>
                        <select id="filter-beds">
                            <option value="">ALL_SIZES</option>
                            <option value="0">STUDIO</option>
                            <option value="1">1_BED</option>
                            <option value="2">2_BED</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>MAX_PRICE.sys</label>
                        <select id="filter-price">
                            <option value="">NO_LIMIT</option>
                            <option value="2000">¬£2,000</option>
                            <option value="2200">¬£2,200</option>
                            <option value="2400">¬£2,400</option>
                            <option value="2600">¬£2,600</option>
                            <option value="2800">¬£2,800</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>POSTCODE.db</label>
                        <select id="filter-postcode">
                            <option value="">ALL_ZONES</option>
                            <option value="N1">N1_ISLINGTON</option>
                            <option value="N4-N8">N4-N8_NORTH</option>
                            <option value="E8">E8_HACKNEY</option>
                            <option value="NW">NW_NORTHWEST</option>
                            <option value="E">E_EAST</option>
                            <option value="Other">OTHER_ZONES</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label>MIN_SCORE.exe</label>
                        <select id="filter-score">
                            <option value="">SHOW_ALL</option>
                            <option value="80">80+_EXCELLENT</option>
                            <option value="70">70+_GOOD</option>
                            <option value="60">60+_FAIR</option>
                            <option value="scored">SCORED_ONLY</option>
                        </select>
                    </div>
                </div>
                <button class="btn-brutalist" onclick="resetFilters()">‚ü≤ RESET ALL</button>
            </div>
        </div>
    </div>

    <!-- RESULTS WINDOW -->
    <div class="window">
        <div class="window-title-bar">
            <div class="window-title">
                <span>üìÅ</span>
                <span>PROPERTIES.DAT - Match Results</span>
            </div>
            <div class="window-controls">
                <div class="window-btn">_</div>
                <div class="window-btn">‚ñ°</div>
                <div class="window-btn" onclick="alert('YOU CANNOT ESCAPE THE PROPERTY MARKET')">√ó</div>
            </div>
        </div>
        <div class="window-content" style="padding: 0;">
            <div class="file-browser">
                <div class="file-browser-header">
                    üìÇ /home/hugo/desperate-flat-hunt/ | Sorted by: MATCH_SCORE (desc)
                </div>
                <table id="properties-table">
                    <thead>
                        <tr>
                            <th class="sortable" data-sort="score">MATCH</th>
                            <th class="sortable" data-sort="address">PROPERTY.FILE</th>
                            <th class="sortable" data-sort="price">PRICE/MO</th>
                            <th class="sortable" data-sort="beds">BEDS</th>
                            <th class="sortable" data-sort="hugo">üö≤ HUGO‚ÜíGYM</th>
                            <th class="sortable" data-sort="holly">üöÜ HOLLY‚ÜíWORK</th>
                            <th>SOURCE</th>
                        </tr>
                    </thead>
                    <tbody id="properties-body">
                        <!-- Populated by JS -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- FOOTER - SHAMELESS TRANSPARENCY -->
    <div class="footer-chaos">
        <div style="border-bottom: 1px solid var(--terminal-green); padding-bottom: 8px; margin-bottom: 8px; font-weight: bold;">
            SHAMELESS CTA & FINE PRINT:
        </div>
        <div>
            ‚Üí Built by Hugo in a state of rental desperation (Dec 2026 escape deadline)<br>
            ‚Üí Not endorsed by estate agents, landlords, or anyone with a mortgage<br>
            ‚Üí Scoring algorithm: 50% commute science, 50% vibes<br>
            ‚Üí Short-term leases only (3-6 months) because we're leaving this country soon<br>
            ‚Üí Press ‚Üë‚Üë‚Üì‚Üì‚Üê‚Üí‚Üê‚ÜíBA for a surprise (Konami code works)<br>
            ‚Üí <a href="https://github.com/inglishugo-nz/flathunt" target="_blank">View source on GitHub</a> | Built with Claude Code + Playwright + Desperation<br>
            ‚Üí If you found this useful, <a href="https://highimpactathletes.com" target="_blank">donate to our charity instead of paying rent</a>
        </div>
    </div>

    <script>
        const properties = [
            {
                score: 91, rank: 1, address: "Islington Park Street, N1", price: 2650, beds: 1, sqft: 645,
                hugo: "10min cycle", hugoScore: 25, holly: "22min to Bank", hollyScore: 25,
                platform: "Zoopla", url: "https://www.zoopla.co.uk/to-rent/details/72531596",
                available: "Now", addedDate: "2026-02-26", area: "N1"
            },
            {
                score: 73, rank: 2, address: "Newington Green Road, N1", price: 2600, beds: 2, sqft: 558,
                hugo: "15min cycle", hugoScore: 20, holly: "30min to Bank", hollyScore: 20,
                platform: "Zoopla", url: "https://www.zoopla.co.uk/to-rent/details/72531020",
                available: "Now", addedDate: "2026-02-26", area: "N1"
            },
            {
                score: 71, rank: 3, address: "Scarborough Road, N4", price: 2400, beds: 2,
                hugo: "10min cycle", hugoScore: 25, holly: "45min to Bank", hollyScore: 10,
                platform: "Rightmove", url: "https://www.rightmove.co.uk/properties/172628444",
                available: "Mid-April", addedDate: "2026-02-26", area: "N4-N8"
            },
            {
                score: 71, rank: 4, address: "Crayford Road, N7", price: 2600, beds: 2,
                hugo: "10min cycle", hugoScore: 25, holly: "45min to Bank", hollyScore: 10,
                platform: "Rightmove", url: "https://www.rightmove.co.uk/properties/172628459",
                available: "Now", addedDate: "2026-02-26", area: "N4-N8"
            },
            {
                score: 68, rank: 5, address: "Broadway Market, E8", price: 2300, beds: 2,
                hugo: "14min cycle", hugoScore: 20, holly: "38min to Bank", hollyScore: 15,
                platform: "Rightmove", url: "https://www.rightmove.co.uk/properties/172627172",
                available: "3 April", addedDate: "2026-02-26", area: "E8"
            },
            {
                score: 66, rank: 6, address: "Crouch Hall Road, N8", price: 2000, beds: 2,
                hugo: "12min cycle", hugoScore: 20, holly: "48min to Bank", hollyScore: 10,
                platform: "Zoopla", url: "https://www.rightmove.co.uk/properties/172628408",
                available: "Now", addedDate: "2026-02-26", area: "N4-N8"
            },
            {
                score: null, address: "Highbury Stadium Mews, N5", price: 2650, beds: 2,
                hugo: "TBC", hugoScore: null, holly: "TBC", hollyScore: null,
                platform: "Zoopla", url: "https://www.zoopla.co.uk/to-rent/details/72530779",
                available: "Now", addedDate: "2026-02-26", area: "N4-N8"
            },
            {
                score: 59, address: "Finchley Road, NW2", price: 2000, beds: 1, sqft: 600,
                hugo: "20min cycle", hugoScore: 15, holly: "52min to Bank", hollyScore: 5,
                platform: "Rightmove", url: "https://www.rightmove.co.uk/properties/172629356",
                available: "Now", addedDate: "2026-02-26", area: "NW"
            },
            {
                score: null, address: "The Fountains, N3", price: 2250, beds: 2,
                hugo: "TBC", hugoScore: null, holly: "TBC", hollyScore: null,
                platform: "Rightmove", url: "https://www.rightmove.co.uk/properties/172627685",
                available: "Now", addedDate: "2026-02-26", area: "NW"
            },
            {
                score: null, address: "Corringham Road, NW11", price: 2250, beds: 2,
                hugo: "TBC", hugoScore: null, holly: "TBC", hollyScore: null,
                platform: "Zoopla", url: "https://www.zoopla.co.uk/to-rent/details/72531452",
                available: "Now", addedDate: "2026-02-26", area: "NW"
            },
            {
                score: null, address: "Camden, NW1", price: 2960, beds: 0,
                hugo: "TBC", hugoScore: null, holly: "TBC", hollyScore: null,
                platform: "Rightmove", url: "https://www.rightmove.co.uk",
                available: "Now", addedDate: "2026-02-26", area: "NW"
            },
            {
                score: null, address: "Whitechapel, E1", price: 2350, beds: 1,
                hugo: "TBC", hugoScore: null, holly: "TBC", hollyScore: null,
                platform: "Rightmove", url: "https://www.rightmove.co.uk",
                available: "Now", addedDate: "2026-02-26", area: "E"
            },
            {
                score: null, address: "Riverlight Quay, SW11", price: 2750, beds: 1,
                hugo: "TBC", hugoScore: null, holly: "TBC", hollyScore: null,
                platform: "Rightmove", url: "https://www.rightmove.co.uk",
                available: "Now", addedDate: "2026-02-26", area: "Other"
            }
        ];

        let currentSort = { column: 'score', direction: 'desc' };

        // EASTER EGG: Konami Code
        let konamiCode = [];
        const konamiSequence = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];

        document.addEventListener('keydown', (e) => {
            konamiCode.push(e.key);
            konamiCode = konamiCode.slice(-10);

            if (konamiCode.join(',') === konamiSequence.join(',')) {
                document.body.classList.add('konami-activated');
                alert('üéÆ KONAMI CODE ACTIVATED! Rainbow mode engaged. The landlords fear you now.');
            }
        });

        function getScoreClass(score) {
            if (score === null) return 'score-unknown';
            if (score >= 80) return 'score-excellent';
            if (score >= 60) return 'score-good';
            return 'score-fair';
        }

        function getCommuteClass(score) {
            if (score === null) return 'commute-unknown';
            if (score >= 20) return 'commute-excellent';
            if (score >= 15) return 'commute-good';
            return 'commute-fair';
        }

        function renderTable(filteredProperties) {
            const tbody = document.getElementById('properties-body');
            tbody.innerHTML = '';

            filteredProperties.forEach(prop => {
                const isTopPick = prop.rank && prop.rank <= 5;
                const row = document.createElement('tr');
                if (isTopPick) row.classList.add('top-pick');

                const newBadge = prop.addedDate === '2026-02-26' ? '<span class="badge-brutal badge-new">NEW</span>' : '';
                const rankBadge = isTopPick ? `<span class="badge-brutal badge-top">‚òÖ TOP ${prop.rank}</span>` : '';
                const starHugo = prop.hugoScore >= 25 ? ' ‚òÖ' : '';
                const starHolly = prop.hollyScore >= 25 ? ' ‚òÖ' : '';

                row.innerHTML = `
                    <td data-label="MATCH">
                        <span class="score-box ${getScoreClass(prop.score)}">
                            ${prop.score !== null ? prop.score : 'TBC'}
                        </span>
                    </td>
                    <td data-label="PROPERTY">
                        ${rankBadge}${newBadge}
                        <br>
                        <a href="${prop.url}" target="_blank" class="property-link">${prop.address}</a>
                        <br>
                        <span class="meta-text">
                            ${prop.sqft ? prop.sqft + ' sqft | ' : ''}${prop.available}
                        </span>
                    </td>
                    <td data-label="PRICE">
                        <strong>¬£${prop.price.toLocaleString()}</strong>
                    </td>
                    <td data-label="BEDS">
                        ${prop.beds === 0 ? 'STUDIO' : prop.beds + 'BR'}
                    </td>
                    <td data-label="HUGO">
                        <span class="commute-text ${getCommuteClass(prop.hugoScore)}">
                            ${prop.hugo}${starHugo}
                        </span>
                    </td>
                    <td data-label="HOLLY">
                        <span class="commute-text ${getCommuteClass(prop.hollyScore)}">
                            ${prop.holly}${starHolly}
                        </span>
                    </td>
                    <td data-label="SOURCE">
                        <span class="meta-text">${prop.platform}</span>
                    </td>
                `;
                tbody.appendChild(row);
            });

            document.getElementById('total-count').textContent = filteredProperties.length;
        }

        function sortProperties(column) {
            if (currentSort.column === column) {
                currentSort.direction = currentSort.direction === 'asc' ? 'desc' : 'asc';
            } else {
                currentSort.column = column;
                currentSort.direction = column === 'score' ? 'desc' : 'asc';
            }

            properties.sort((a, b) => {
                let valA = a[column];
                let valB = b[column];

                if (column === 'score') {
                    if (valA === null && valB === null) return 0;
                    if (valA === null) return currentSort.direction === 'desc' ? 1 : -1;
                    if (valB === null) return currentSort.direction === 'desc' ? -1 : 1;
                }

                if (typeof valA === 'string') {
                    valA = valA.toLowerCase();
                    valB = valB.toLowerCase();
                }

                return currentSort.direction === 'asc'
                    ? (valA > valB ? 1 : -1)
                    : (valA < valB ? 1 : -1);
            });

            updateSortIndicators();
            applyFilters();
        }

        function updateSortIndicators() {
            document.querySelectorAll('th.sortable').forEach(th => {
                th.classList.remove('sorted-asc', 'sorted-desc');
                if (th.dataset.sort === currentSort.column) {
                    th.classList.add(currentSort.direction === 'asc' ? 'sorted-asc' : 'sorted-desc');
                }
            });
        }

        function applyFilters() {
            const beds = document.getElementById('filter-beds').value;
            const maxPrice = document.getElementById('filter-price').value;
            const area = document.getElementById('filter-postcode').value;
            const minScore = document.getElementById('filter-score').value;

            let filtered = properties.filter(prop => {
                if (beds && prop.beds !== parseInt(beds)) return false;
                if (maxPrice && prop.price > parseInt(maxPrice)) return false;
                if (minScore === 'scored' && prop.score === null) return false;
                if (minScore && minScore !== 'scored' && (prop.score === null || prop.score < parseInt(minScore))) return false;
                if (area && prop.area !== area) return false;
                return true;
            });

            renderTable(filtered);
        }

        function resetFilters() {
            document.getElementById('filter-beds').value = '';
            document.getElementById('filter-price').value = '';
            document.getElementById('filter-postcode').value = '';
            document.getElementById('filter-score').value = '';
            applyFilters();
        }

        document.querySelectorAll('th.sortable').forEach(th => {
            th.addEventListener('click', () => sortProperties(th.dataset.sort));
        });

        document.querySelectorAll('.filter-panel select').forEach(select => {
            select.addEventListener('change', applyFilters);
        });

        sortProperties('score');
    </script>
</body>
</html>
